Index: main.go
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package main\r\n\r\nimport (\r\n\t\"flag\"\r\n\t\"fmt\"\r\n\t\"go-scrape-redmine/config\"\r\n\t\"go-scrape-redmine/crawl/pherusa\"\r\n\t_ \"go-scrape-redmine/crawl/pherusa\"\r\n\tRedmine \"go-scrape-redmine/crawl/redmine\"\r\n\t\"go-scrape-redmine/models\"\r\n\tMember \"go-scrape-redmine/seed/members\"\r\n\t\"go-scrape-redmine/server\"\r\n\t\"sync\"\r\n\r\n\t\"github.com/robfig/cron/v3\"\r\n)\r\n\r\nconst num_workers = 1\r\n\r\nfunc main() {\r\n\r\n\tconfig.LoadENV()\r\n\tdb := config.DBConnect()\r\n\tmodels.DBMigrate(db)\r\n\tvar seed string\r\n\tflag.StringVar(&seed, \"seed\", \"none\", \"seed option\")\r\n\tflag.Parse()\r\n\r\n\tif seed == \"member\" {\r\n\t\tfmt.Println(\"Importing member\")\r\n\t\tMember.NewMember().SeedMember()\r\n\t\treturn\r\n\t} else if seed == \"issue\" {\r\n\t\tfmt.Println(\"Importing issue\")\r\n\t\tRedmine.NewRedmine().CrawlRedmine()\r\n\t\tpherusa.NewPherusa().CrawlPherusa()\r\n\t\treturn\r\n\t} else if seed != \"none\" {\r\n\t\tfmt.Println(\"Flag seed invalid\")\r\n\t\treturn\r\n\t}\r\n\r\n\tvar wg sync.WaitGroup\r\n\twg.Add(num_workers)\r\n\r\n\tcr := cron.New()\r\n\tcr.AddFunc(\"0 18 * * *\", Redmine.NewRedmine().CrawlRedmine)\r\n\tcr.Start()\r\n\r\n\tgo server.Run(&wg)\r\n\twg.Wait()\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/main.go b/main.go
--- a/main.go	(revision 415a238c65e6547eadb7acb57f7f87e72766bc80)
+++ b/main.go	(date 1639034809380)
@@ -3,6 +3,7 @@
 import (
 	"flag"
 	"fmt"
+	"go-scrape-redmine/Notify"
 	"go-scrape-redmine/config"
 	"go-scrape-redmine/crawl/pherusa"
 	_ "go-scrape-redmine/crawl/pherusa"
@@ -32,9 +33,15 @@
 		return
 	} else if seed == "issue" {
 		fmt.Println("Importing issue")
-		Redmine.NewRedmine().CrawlRedmine()
+		//Redmine.NewRedmine().CrawlRedmine()
 		pherusa.NewPherusa().CrawlPherusa()
 		return
+	} else if seed == "getissue" {
+		Notify.NewNotify(db).GetIssueOverdueStatusNone("pherusa")
+		return
+	} else if seed == "chatwork" {
+		Notify.NotiChatWork()
+		return
 	} else if seed != "none" {
 		fmt.Println("Flag seed invalid")
 		return
@@ -45,6 +52,7 @@
 
 	cr := cron.New()
 	cr.AddFunc("0 18 * * *", Redmine.NewRedmine().CrawlRedmine)
+	cr.AddFunc("0 18 * * *", Notify.NotiChatWork)
 	cr.Start()
 
 	go server.Run(&wg)
